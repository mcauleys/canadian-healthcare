---
title: "R Notebook"
output: html_notebook
---

Import required libraries
```{r}
library(tidyverse)
```

Import data
```{r}
names <- read.csv("healthcare-investors-names.csv", header = TRUE)
country <- read.csv("healthcare-investors-country.csv", header = TRUE)
value <- read.csv("healthcare-investors-value.csv", header = TRUE)
os <- read.csv("healthcare-investors-os.csv", header = TRUE)

```


```{r}
df <- data.frame()

for (ticker in names(names)){
  
  if (names[,ticker][1] == "#N/A"){
    next()
  }
  
  investors <- as.character(names[,ticker][names[,ticker] != ""])
  tick <- rep(ticker, length(investors))
  loc <- as.character(country[,ticker][country[,ticker] != ""])
  val <- value[,ticker][!is.na(value[,ticker])]
  out <- os[,ticker][!is.na(os[,ticker])]
  
  t <- cbind(tick, investors, loc, val, out)
  
  df <- rbind(df,t)
}

df$val <- as.numeric(as.character(df$val))
df$out <- as.numeric(as.character(df$out))

df.investor <- df %>% group_by(investors, loc) %>% summarise(count = n(), total = sum(val))

```

```{r}
summary(df.investor)
```


```{r}
ylab = c(200, 400, 600, 800)

ggplot(df.investor) +
  geom_point(aes(x = count, y = total), size = 2, colour = "#2d465f") +
  scale_y_continuous(labels = paste0(ylab, "M"), breaks = 10^6 * ylab) +
  scale_x_continuous(breaks = c(1:21)) +
  labs(y = "Total investment ($)", x = "Number of investments")

```


